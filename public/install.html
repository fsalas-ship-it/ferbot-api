<!doctype html>
<html lang="es" class="h-full">
<head>
  <meta charset="utf-8" />
  <title>FerBot ¬∑ Instalaci√≥n y Uso</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --green:#97C93E; --bg:#0b0f19; --card:#0f1524; --muted:#94a3b8; --text:#e2e8f0; --line:rgba(255,255,255,.08);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;
         background:radial-gradient(1200px 700px at 80% -10%, rgba(151,201,62,.15), transparent 60%), var(--bg);
         color:var(--text);}
    .wrap{max-width:1000px; margin:0 auto; padding:28px 16px 48px;}
    .hero{display:flex; gap:16px; align-items:center; justify-content:space-between; margin-bottom:16px}
    .title{display:flex; align-items:center; gap:10px}
    .title h1{margin:0; font-size:22px}
    .badge{padding:6px 10px; border:1px solid var(--line); border-radius:999px; color:var(--muted); font-size:13px}
    .grid{display:grid; gap:16px}
    @media(min-width:900px){ .grid-2{grid-template-columns:1fr 1fr} }
    .card{background:var(--card); border:1px solid var(--line); border-radius:14px; padding:16px}
    .card h2{margin:0 0 8px; font-size:18px}
    .card h3{margin:0 0 8px; font-size:16px}
    .muted{color:var(--muted); font-size:14px}
    .row{display:flex; gap:8px; flex-wrap:wrap; align-items:center}
    .btn{border:0; border-radius:10px; padding:10px 14px; font-weight:700; cursor:pointer}
    .btn-primary{background:var(--green); color:#0b0f19}
    .btn-ghost{background:#121a2b; color:var(--text); border:1px solid var(--line)}
    .btn-link{background:transparent; color:var(--green); border:0; padding:0; font-weight:700; cursor:pointer}
    .divider{height:1px; background:var(--line); margin:14px 0}
    code, .kbd{background:#0b1020; color:#dbeafe; border:1px solid var(--line); border-radius:8px; padding:2px 6px; font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; font-size:12px}
    .step{display:flex; gap:10px; align-items:flex-start; margin:10px 0}
    .step-num{width:26px; height:26px; min-width:26px; border-radius:999px; background:#121a2b; border:1px solid var(--line); display:flex; align-items:center; justify-content:center; color:var(--muted); font-weight:700; font-size:13px}
    .pill{padding:4px 8px; border-radius:999px; border:1px solid var(--line); color:var(--muted); font-size:12px}
    .ok{color:#19c37d}
    .warn{color:#f59e0b}
    .err{color:#ef4444}
    .toast{position:fixed; right:18px; bottom:18px; background:#11182a; border:1px solid var(--line); border-radius:12px; padding:12px 14px; display:none}
    details{border:1px solid var(--line); border-radius:12px; padding:10px; background:#0e1628}
    summary{cursor:pointer; font-weight:700}
    .kbd{margin:0 2px}
    .link{color:var(--green); text-decoration:none}
    .stat{display:flex; justify-content:space-between; align-items:center; padding:10px 12px; background:#0c1322; border:1px solid var(--line); border-radius:10px}
    .stat b{font-size:16px}
    .footer{margin-top:24px; color:var(--muted); font-size:13px}
    .heart{color:var(--green)}
    .mono{font-family:ui-monospace,Monaco,Menlo,Consolas,monospace}
    .os-tabs{display:flex; gap:8px; margin:8px 0 2px}
    .os-tabs .tab{padding:6px 10px; border-radius:999px; border:1px solid var(--line); cursor:pointer; font-weight:700; font-size:13px; color:var(--muted)}
    .os-tabs .tab.active{background:var(--green); color:#0b0f19; border-color:transparent}
    .hidden{display:none}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="hero">
      <div class="title">
        <div class="pill">FERBOT</div>
        <h1>Instalaci√≥n & Uso (Extensi√≥n + Panel)</h1>
      </div>
      <div class="row">
        <span class="badge" id="apiBadge">API: comprobando‚Ä¶</span>
        <span class="badge">Soporte: <a class="link" href="mailto:fsalas@platzi.com">fsalas@platzi.com</a> ¬∑ Slack: @ferney salas</span>
      </div>
    </div>

    <div class="grid grid-2">
      <!-- Descargas -->
      <section class="card">
        <h2>1) Descarga</h2>
        <p class="muted">Baja la extensi√≥n lista y abre el panel de emergencia (por si Chrome no est√° disponible).</p>
        <div class="row">
          <!-- Reemplaza estos HREF por tus enlaces reales de Google Drive -->
          <a id="dlZip" href="https://drive.google.com/uc?export=download&id=REEMPLAZA_ID_ZIP" class="btn btn-primary">‚¨áÔ∏è Descargar extensi√≥n (.zip)</a>
          <a href="https://ferbot-api.onrender.com/agent.html" class="btn btn-ghost">üß™ Panel de emergencia</a>
          <a href="https://ferbot-api.onrender.com/dashboard.html" class="btn btn-ghost">üìä Dashboard</a>
        </div>
        <div class="divider"></div>
        <div class="stat"><span>Estado de la API</span><b id="apiState">‚Äî</b></div>
        <div class="stat"><span>Modelo</span><b id="apiModel">‚Äî</b></div>
      </section>

      <!-- Chrome -->
      <section class="card">
        <h2>2) Instalar en Chrome</h2>
        <p class="muted">No requiere permisos especiales. Se instala una vez y queda lista.</p>
        <div class="step"><div class="step-num">1</div><div>Descomprime el <b>.zip</b> descargado en una carpeta (por ejemplo: <span class="mono">FerBot_Extension/</span>).</div></div>
        <div class="step"><div class="step-num">2</div><div>Abre <b>chrome://extensions</b> (copia y pega en la barra de Chrome).</div></div>
        <div class="step"><div class="step-num">3</div><div>Activa <b>Modo desarrollador</b> (esquina superior derecha).</div></div>
        <div class="step"><div class="step-num">4</div><div>Haz clic en <b>Cargar descomprimida</b> y selecciona la carpeta <span class="mono">FerBot_Extension/</span>.</div></div>
        <div class="step"><div class="step-num">5</div><div>Ver√°s el bot√≥n ü§ñ en Hilos/CRM. Puedes arrastrarlo, abrir/cerrar y usarlo al instante.</div></div>
        <div class="divider"></div>
        <details>
          <summary>Permitir en el sitio</summary>
          <p class="muted">Si no aparece el bot√≥n ü§ñ, entra en <b>chrome://extensions</b> ‚Üí FerBot ‚Üí <b>Detalles</b> ‚Üí ‚ÄúPermitir acceso a URL del sitio‚Äù o ‚ÄúPermitir en todos los sitios‚Äù.</p>
        </details>
      </section>

      <!-- Config -->
      <section class="card">
        <h2>3) Configuraci√≥n (0 pasos obligatorios)</h2>
        <p class="muted">La extensi√≥n ya apunta a <b>Render</b>: <code>https://ferbot-api.onrender.com</code>. No hace falta tocar nada. Solo si un d√≠a apuntas a otro servidor, usa estos comandos:</p>
        <div class="os-tabs">
          <button class="tab active" data-os="mac">macOS</button>
          <button class="tab" data-os="win">Windows</button>
        </div>
        <div id="mac" class="os-panel">
          <div class="step"><div class="step-num">1</div><div>Abre el sitio donde usar√°s FerBot y luego <span class="kbd">‚å•</span>+<span class="kbd">‚åò</span>+<span class="kbd">J</span> (Console).</div></div>
          <div class="step"><div class="step-num">2</div><div>Pega y <b>Enter</b>:</div></div>
          <pre><code>localStorage.setItem("ferbot_api_base", "https://ferbot-api.onrender.com")
location.reload()</code></pre>
        </div>
        <div id="win" class="os-panel hidden">
          <div class="step"><div class="step-num">1</div><div>Abre el sitio y luego <span class="kbd">Ctrl</span>+<span class="kbd">Shift</span>+<span class="kbd">J</span> (Console).</div></div>
          <div class="step"><div class="step-num">2</div><div>Pega y <b>Enter</b>:</div></div>
          <pre><code>localStorage.setItem("ferbot_api_base", "https://ferbot-api.onrender.com")
location.reload()</code></pre>
        </div>
        <p class="muted">Para volver a la URL por defecto, ejecuta: <code>localStorage.removeItem("ferbot_api_base")</code></p>
      </section>

      <!-- Uso -->
      <section class="card">
        <h2>4) Uso ultra-r√°pido</h2>
        <div class="step"><div class="step-num">1</div><div><b>Abre el ü§ñ</b> (bot√≥n flotante). Escribe o selecciona el texto del cliente.</div></div>
        <div class="step"><div class="step-num">2</div><div>Elige <b>Etapa</b> (Integraci√≥n / Sondeo / Rebatir / Pre-cierre / Cierre).</div></div>
        <div class="step"><div class="step-num">3</div><div>Presiona <b>Generar</b>. Ver√°s: <b>Respuesta</b> (para pegar) y <b>POR QU√â + SIGUIENTE PASO</b> (para aprender).</div></div>
        <div class="step"><div class="step-num">4</div><div>Califica la respuesta (üëçüòêüëé). Esto entrena el ranking y el dashboard.</div></div>
        <div class="divider"></div>
        <ul class="muted" style="margin:0 0 0 18px">
          <li>Autopaste est√° <b>OFF</b> por defecto. Act√≠valo si quieres pegar autom√°tico.</li>
          <li>El <b>countdown</b> rojo‚Üí√°mbar‚Üíverde muestra el tiempo de respuesta del modelo.</li>
          <li>El <b>an√°lisis de sentimiento</b> aparece junto al texto del cliente (compacto y ‚Äútech‚Äù).</li>
        </ul>
      </section>

      <!-- Troubleshooting -->
      <section class="card">
        <h2>5) Errores frecuentes</h2>
        <details open>
          <summary><span class="err">No aparece el bot√≥n ü§ñ</span></summary>
          <p class="muted">Ve a <b>chrome://extensions</b> ‚Üí FerBot ‚Üí Detalles ‚Üí activa ‚ÄúPermitir en todos los sitios‚Äù. Refresca la p√°gina.</p>
        </details>
        <div class="divider"></div>
        <details>
          <summary><span class="warn">‚ÄúNo se pudo generar (HTTP 500)‚Äù</span></summary>
          <p class="muted">Abre <a class="link" href="https://ferbot-api.onrender.com/health" target="_blank">/health</a>. Debe mostrar <code>{"ok":true,"openai":true,...}</code>. Si no, avisa a soporte.</p>
        </details>
        <div class="divider"></div>
        <details>
          <summary><span class="warn">Render ‚Äúduerme‚Äù</span></summary>
          <p class="muted">Tenemos keepalive configurado. Si tarda la primera vez, es normal (arranque en fr√≠o). Reintenta y luego quedar√° activo.</p>
        </details>
        <div class="divider"></div>
        <details>
          <summary><span class="ok">¬øEl panel de emergencia entrena?</span></summary>
          <p class="muted">S√≠. Las calificaciones del panel tambi√©n impactan el dashboard.</p>
        </details>
      </section>
    </div>

    <div class="footer">
      Hecho con <span class="heart">‚ù§</span> para acelerar ventas en Platzi. ¬∑ FerBot usa respuestas cortas (‚â§220c), por etapas, y ense√±a con POR QU√â/SIGUIENTE PASO.
    </div>
  </div>

  <div class="toast" id="toast">Copiado</div>

  <script>
    // --- OS Tabs
    const tabs = document.querySelectorAll('.os-tabs .tab');
    const panels = { mac: document.getElementById('mac'), win: document.getElementById('win') };
    function activate(os){
      tabs.forEach(t=>t.classList.toggle('active', t.dataset.os===os));
      panels.mac.classList.toggle('hidden', os!=='mac');
      panels.win.classList.toggle('hidden', os!=='win');
    }
    tabs.forEach(t=> t.addEventListener('click', ()=> activate(t.dataset.os)));
    // Detect OS
    (() => {
      const ua = navigator.userAgent.toLowerCase();
      if (ua.includes('mac')) activate('mac'); else activate('win');
    })();

    // --- API Health ping
    (async () => {
      const apiBadge = document.getElementById('apiBadge');
      const apiState = document.getElementById('apiState');
      const apiModel = document.getElementById('apiModel');
      try{
        const r = await fetch('https://ferbot-api.onrender.com/health', {cache:'no-store'});
        if(!r.ok) throw new Error('bad http');
        const j = await r.json();
        apiBadge.textContent = j.ok ? 'API: OK' : 'API: error';
        apiBadge.style.color = j.ok ? '#19c37d' : '#ef4444';
        apiState.textContent = j.ok ? 'Disponible' : 'Ca√≠da';
        apiModel.textContent = j.model_env || '(modelo no reportado)';
      }catch(e){
        apiBadge.textContent = 'API: error';
        apiBadge.style.color = '#ef4444';
        apiState.textContent = 'No disponible';
        apiModel.textContent = '‚Äî';
      }
    })();

    // --- Copy helper (for future buttons if needed)
    function showToast(msg='Copiado'){
      const t = document.getElementById('toast');
      t.textContent = msg; t.style.display='block';
      setTimeout(()=> t.style.display='none', 1200);
    }
  </script>
</body>
</html>
